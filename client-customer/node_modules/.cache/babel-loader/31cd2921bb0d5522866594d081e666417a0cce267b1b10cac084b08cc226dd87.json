{"ast":null,"code":"import _classCallCheck from\"D:/VLU/ShoppeClone/client-customer/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"D:/VLU/ShoppeClone/client-customer/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"D:/VLU/ShoppeClone/client-customer/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"D:/VLU/ShoppeClone/client-customer/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component}from\"react\";import MyContext from\"../contexts/MyContext\";import CartUtil from\"../utils/CartUtil\";import axios from\"axios\";import withRouter from\"../utils/withRouter\";import swal from\"sweetalert\";import Button from'react-bootstrap/Button';//import Table from 'react-bootstrap/Table';\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Mycart=/*#__PURE__*/function(_Component){_inherits(Mycart,_Component);var _super=_createSuper(Mycart);function Mycart(){_classCallCheck(this,Mycart);return _super.apply(this,arguments);}_createClass(Mycart,[{key:\"render\",value:// using this.context to access global state\nfunction render(){var _this=this;var mycart=this.context.mycart.map(function(item,index){return/*#__PURE__*/_jsxs(\"tr\",{className:\"datatable\",children:[/*#__PURE__*/_jsx(\"td\",{children:index+1}),/*#__PURE__*/_jsx(\"td\",{children:item.product._id}),/*#__PURE__*/_jsx(\"td\",{children:item.product.name}),/*#__PURE__*/_jsx(\"td\",{children:item.product.category.name}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"img\",{src:\"data:image/jpg;base64,\"+item.product.image,width:\"70px\",height:\"70px\",alt:\"\"})}),/*#__PURE__*/_jsx(\"td\",{children:item.product.author}),/*#__PURE__*/_jsx(\"td\",{children:item.product.price}),/*#__PURE__*/_jsx(\"td\",{children:item.quantity}),/*#__PURE__*/_jsx(\"td\",{children:item.product.price*item.quantity}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Button,{variant:\"danger\",className:\"link\",onClick:function onClick(){return _this.lnkRemoveClick(item.product._id);},children:\"Remove\"})})]},item.product._id);});return/*#__PURE__*/_jsxs(\"div\",{className:\"align-center\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-center\",children:\"ITEM LIST\"}),/*#__PURE__*/_jsx(\"table\",{striped:true,bordered:true,hover:true,className:\"datatable\",children:/*#__PURE__*/_jsxs(\"tbody\",{children:[/*#__PURE__*/_jsxs(\"tr\",{className:\"datatable\",children:[/*#__PURE__*/_jsx(\"th\",{className:\"width_item\",children:\"No.\"}),/*#__PURE__*/_jsx(\"th\",{className:\"width_item\",children:\"ID\"}),/*#__PURE__*/_jsx(\"th\",{className:\"width_item\",children:\"Category\"}),/*#__PURE__*/_jsx(\"th\",{className:\"width_item\",children:\"Name\"}),/*#__PURE__*/_jsx(\"th\",{className:\"width_item\",children:\"Image\"}),/*#__PURE__*/_jsx(\"th\",{className:\"width_item\",children:\"Author\"}),/*#__PURE__*/_jsx(\"th\",{className:\"width_item\",children:\"Price\"}),/*#__PURE__*/_jsx(\"th\",{className:\"width_item\",children:\"Quantity\"}),/*#__PURE__*/_jsx(\"th\",{className:\"width_item\",children:\"Amount\"}),/*#__PURE__*/_jsx(\"th\",{className:\"width_item\",children:\"Action\"})]}),mycart,/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{colSpan:\"7\"}),/*#__PURE__*/_jsx(\"td\",{children:\"Total\"}),/*#__PURE__*/_jsx(\"td\",{children:CartUtil.getTotal(this.context.mycart)}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"button\",{className:\"link\",onClick:function onClick(){return _this.lnkCheckoutClick();},children:\"CHECKOUT\"})})]})]})})]});}// event-handlers\n},{key:\"lnkRemoveClick\",value:function lnkRemoveClick(id){var mycart=this.context.mycart;var index=mycart.findIndex(function(x){return x.product._id===id;});if(index!==-1){// found, remove item\nmycart.splice(index,1);this.context.setMycart(mycart);}}},{key:\"lnkCheckoutClick\",value:function lnkCheckoutClick(){var _this2=this;swal({title:\"Are you sure?\",text:\"Once checkout, you will not be able to redo this!\",icon:\"warning\",buttons:true,dangerMode:true}).then(function(willCheckout){if(willCheckout){if(_this2.context.mycart.length>0){var total=CartUtil.getTotal(_this2.context.mycart);var items=_this2.context.mycart;var customer=_this2.context.customer;if(customer){_this2.apiCheckout(total,items,customer);}else{_this2.props.navigate(\"/login\");}}else{swal({title:\"Your cart is empty\",icon:\"warning\",button:\"OK\"});}}});}// apis\n},{key:\"apiCheckout\",value:function apiCheckout(total,items,customer){var _this3=this;var body={total:total,items:items,customer:customer};var config={headers:{\"x-access-token\":this.context.token}};axios.post(\"/api/customer/checkout\",body,config).then(function(res){var result=res.data;if(result){_this3.context.setMycart([]);_this3.props.navigate(\"/home\");}else{alert(\"Checkout failed\");}});}}]);return Mycart;}(Component);Mycart.contextType=MyContext;export default withRouter(Mycart);","map":{"version":3,"names":["React","Component","MyContext","CartUtil","axios","withRouter","swal","Button","jsx","_jsx","jsxs","_jsxs","Mycart","_Component","_inherits","_super","_createSuper","_classCallCheck","apply","arguments","_createClass","key","value","render","_this","mycart","context","map","item","index","className","children","product","_id","name","category","src","image","width","height","alt","author","price","quantity","variant","onClick","lnkRemoveClick","striped","bordered","hover","colSpan","getTotal","lnkCheckoutClick","id","findIndex","x","splice","setMycart","_this2","title","text","icon","buttons","dangerMode","then","willCheckout","length","total","items","customer","apiCheckout","props","navigate","button","_this3","body","config","headers","token","post","res","result","data","alert","contextType"],"sources":["D:/VLU/ShoppeClone/client-customer/src/components/MycartComponent.js"],"sourcesContent":["import React, { Component } from \"react\";\r\nimport MyContext from \"../contexts/MyContext\";\r\nimport CartUtil from \"../utils/CartUtil\";\r\nimport axios from \"axios\";\r\nimport withRouter from \"../utils/withRouter\";\r\nimport swal from \"sweetalert\";\r\nimport Button from 'react-bootstrap/Button';\r\n//import Table from 'react-bootstrap/Table';\r\n\r\nclass Mycart extends Component {\r\n  static contextType = MyContext; // using this.context to access global state\r\n  render() {\r\n    const mycart = this.context.mycart.map((item, index) => {\r\n      return (\r\n        <tr key={item.product._id} className=\"datatable\">\r\n          <td>{index + 1}</td>\r\n          <td>{item.product._id}</td>\r\n          <td>{item.product.name}</td>\r\n          <td>{item.product.category.name}</td>\r\n          <td>\r\n            <img\r\n              src={\"data:image/jpg;base64,\" + item.product.image}\r\n              width=\"70px\"\r\n              height=\"70px\"\r\n              alt=\"\"\r\n            />\r\n          </td>\r\n          <td>{item.product.author}</td>\r\n          <td>{item.product.price}</td>\r\n          <td>{item.quantity}</td>\r\n          <td>{item.product.price * item.quantity}</td>\r\n          <td>\r\n            <Button variant=\"danger\"\r\n              className=\"link\"\r\n              onClick={() => this.lnkRemoveClick(item.product._id)}\r\n            >\r\n              Remove\r\n            </Button>\r\n          </td>\r\n        </tr>\r\n      );\r\n    });\r\n    return (\r\n      <div className=\"align-center\">\r\n        <h2 className=\"text-center\">ITEM LIST</h2>\r\n        {/* <table className=\"datatable\" border=\"1\"> */}\r\n        <table striped bordered hover className=\"datatable\">\r\n          <tbody>\r\n            <tr className=\"datatable\">\r\n              <th className=\"width_item\">No.</th>\r\n              <th className=\"width_item\">ID</th>\r\n              <th className=\"width_item\">Category</th>\r\n              <th className=\"width_item\">Name</th>\r\n              <th className=\"width_item\">Image</th>\r\n              <th className=\"width_item\">Author</th>\r\n              <th className=\"width_item\">Price</th>\r\n              <th className=\"width_item\">Quantity</th>\r\n              <th className=\"width_item\">Amount</th>\r\n              <th className=\"width_item\">Action</th>\r\n            </tr>\r\n            {mycart}\r\n            <tr>\r\n              <td colSpan=\"7\"></td>\r\n              <td>Total</td>\r\n              <td>{CartUtil.getTotal(this.context.mycart)}</td>\r\n              <td>\r\n                <button className=\"link\" onClick={() => this.lnkCheckoutClick()}>\r\n                  CHECKOUT\r\n                </button>\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    );\r\n  }\r\n  // event-handlers\r\n  lnkRemoveClick(id) {\r\n    const mycart = this.context.mycart;\r\n    const index = mycart.findIndex((x) => x.product._id === id);\r\n    if (index !== -1) {\r\n      // found, remove item\r\n      mycart.splice(index, 1);\r\n      this.context.setMycart(mycart);\r\n    }\r\n  }\r\n  lnkCheckoutClick() {\r\n    swal({\r\n      title: \"Are you sure?\",\r\n      text: \"Once checkout, you will not be able to redo this!\",\r\n      icon: \"warning\",\r\n      buttons: true,\r\n      dangerMode: true,\r\n    }).then((willCheckout) => {\r\n      if (willCheckout) {\r\n        if (this.context.mycart.length > 0) {\r\n          const total = CartUtil.getTotal(this.context.mycart);\r\n          const items = this.context.mycart;\r\n          const customer = this.context.customer;\r\n          if (customer) {\r\n            this.apiCheckout(total, items, customer);\r\n          } else {\r\n            this.props.navigate(\"/login\");\r\n          }\r\n        } else {\r\n          swal({\r\n            title: \"Your cart is empty\",\r\n            icon: \"warning\",\r\n            button: \"OK\",\r\n          });\r\n        }\r\n      }\r\n    });\r\n  }\r\n  // apis\r\n  apiCheckout(total, items, customer) {\r\n    const body = { total: total, items: items, customer: customer };\r\n    const config = { headers: { \"x-access-token\": this.context.token } };\r\n    axios.post(\"/api/customer/checkout\", body, config).then((res) => {\r\n      const result = res.data;\r\n      if (result) {\r\n        this.context.setMycart([]);\r\n        this.props.navigate(\"/home\");\r\n      } else {\r\n        alert(\"Checkout failed\");\r\n      }\r\n    });\r\n  }\r\n}\r\nexport default withRouter(Mycart);\r\n"],"mappings":"gdAAA,MAAO,CAAAA,KAAK,EAAIC,SAAS,KAAQ,OAAO,CACxC,MAAO,CAAAC,SAAS,KAAM,uBAAuB,CAC7C,MAAO,CAAAC,QAAQ,KAAM,mBAAmB,CACxC,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,CAAAC,UAAU,KAAM,qBAAqB,CAC5C,MAAO,CAAAC,IAAI,KAAM,YAAY,CAC7B,MAAO,CAAAC,MAAM,KAAM,wBAAwB,CAC3C;AAAA,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,4BAEM,CAAAC,MAAM,uBAAAC,UAAA,EAAAC,SAAA,CAAAF,MAAA,CAAAC,UAAA,MAAAE,MAAA,CAAAC,YAAA,CAAAJ,MAAA,WAAAA,OAAA,EAAAK,eAAA,MAAAL,MAAA,SAAAG,MAAA,CAAAG,KAAA,MAAAC,SAAA,GAAAC,YAAA,CAAAR,MAAA,GAAAS,GAAA,UAAAC,KAAA,CACsB;AAChC,SAAAC,OAAA,CAAS,KAAAC,KAAA,MACP,GAAM,CAAAC,MAAM,CAAG,IAAI,CAACC,OAAO,CAACD,MAAM,CAACE,GAAG,CAAC,SAACC,IAAI,CAAEC,KAAK,CAAK,CACtD,mBACElB,KAAA,OAA2BmB,SAAS,CAAC,WAAW,CAAAC,QAAA,eAC9CtB,IAAA,OAAAsB,QAAA,CAAKF,KAAK,CAAG,CAAC,CAAK,CAAC,cACpBpB,IAAA,OAAAsB,QAAA,CAAKH,IAAI,CAACI,OAAO,CAACC,GAAG,CAAK,CAAC,cAC3BxB,IAAA,OAAAsB,QAAA,CAAKH,IAAI,CAACI,OAAO,CAACE,IAAI,CAAK,CAAC,cAC5BzB,IAAA,OAAAsB,QAAA,CAAKH,IAAI,CAACI,OAAO,CAACG,QAAQ,CAACD,IAAI,CAAK,CAAC,cACrCzB,IAAA,OAAAsB,QAAA,cACEtB,IAAA,QACE2B,GAAG,CAAE,wBAAwB,CAAGR,IAAI,CAACI,OAAO,CAACK,KAAM,CACnDC,KAAK,CAAC,MAAM,CACZC,MAAM,CAAC,MAAM,CACbC,GAAG,CAAC,EAAE,CACP,CAAC,CACA,CAAC,cACL/B,IAAA,OAAAsB,QAAA,CAAKH,IAAI,CAACI,OAAO,CAACS,MAAM,CAAK,CAAC,cAC9BhC,IAAA,OAAAsB,QAAA,CAAKH,IAAI,CAACI,OAAO,CAACU,KAAK,CAAK,CAAC,cAC7BjC,IAAA,OAAAsB,QAAA,CAAKH,IAAI,CAACe,QAAQ,CAAK,CAAC,cACxBlC,IAAA,OAAAsB,QAAA,CAAKH,IAAI,CAACI,OAAO,CAACU,KAAK,CAAGd,IAAI,CAACe,QAAQ,CAAK,CAAC,cAC7ClC,IAAA,OAAAsB,QAAA,cACEtB,IAAA,CAACF,MAAM,EAACqC,OAAO,CAAC,QAAQ,CACtBd,SAAS,CAAC,MAAM,CAChBe,OAAO,CAAE,SAAAA,QAAA,QAAM,CAAArB,KAAI,CAACsB,cAAc,CAAClB,IAAI,CAACI,OAAO,CAACC,GAAG,CAAC,EAAC,CAAAF,QAAA,CACtD,QAED,CAAQ,CAAC,CACP,CAAC,GAxBEH,IAAI,CAACI,OAAO,CAACC,GAyBlB,CAAC,CAET,CAAC,CAAC,CACF,mBACEtB,KAAA,QAAKmB,SAAS,CAAC,cAAc,CAAAC,QAAA,eAC3BtB,IAAA,OAAIqB,SAAS,CAAC,aAAa,CAAAC,QAAA,CAAC,WAAS,CAAI,CAAC,cAE1CtB,IAAA,UAAOsC,OAAO,MAACC,QAAQ,MAACC,KAAK,MAACnB,SAAS,CAAC,WAAW,CAAAC,QAAA,cACjDpB,KAAA,UAAAoB,QAAA,eACEpB,KAAA,OAAImB,SAAS,CAAC,WAAW,CAAAC,QAAA,eACvBtB,IAAA,OAAIqB,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,KAAG,CAAI,CAAC,cACnCtB,IAAA,OAAIqB,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,IAAE,CAAI,CAAC,cAClCtB,IAAA,OAAIqB,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,UAAQ,CAAI,CAAC,cACxCtB,IAAA,OAAIqB,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,MAAI,CAAI,CAAC,cACpCtB,IAAA,OAAIqB,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,OAAK,CAAI,CAAC,cACrCtB,IAAA,OAAIqB,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,QAAM,CAAI,CAAC,cACtCtB,IAAA,OAAIqB,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,OAAK,CAAI,CAAC,cACrCtB,IAAA,OAAIqB,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,UAAQ,CAAI,CAAC,cACxCtB,IAAA,OAAIqB,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,QAAM,CAAI,CAAC,cACtCtB,IAAA,OAAIqB,SAAS,CAAC,YAAY,CAAAC,QAAA,CAAC,QAAM,CAAI,CAAC,EACpC,CAAC,CACJN,MAAM,cACPd,KAAA,OAAAoB,QAAA,eACEtB,IAAA,OAAIyC,OAAO,CAAC,GAAG,CAAK,CAAC,cACrBzC,IAAA,OAAAsB,QAAA,CAAI,OAAK,CAAI,CAAC,cACdtB,IAAA,OAAAsB,QAAA,CAAK5B,QAAQ,CAACgD,QAAQ,CAAC,IAAI,CAACzB,OAAO,CAACD,MAAM,CAAC,CAAK,CAAC,cACjDhB,IAAA,OAAAsB,QAAA,cACEtB,IAAA,WAAQqB,SAAS,CAAC,MAAM,CAACe,OAAO,CAAE,SAAAA,QAAA,QAAM,CAAArB,KAAI,CAAC4B,gBAAgB,CAAC,CAAC,EAAC,CAAArB,QAAA,CAAC,UAEjE,CAAQ,CAAC,CACP,CAAC,EACH,CAAC,EACA,CAAC,CACH,CAAC,EACL,CAAC,CAEV,CACA;AAAA,GAAAV,GAAA,kBAAAC,KAAA,CACA,SAAAwB,eAAeO,EAAE,CAAE,CACjB,GAAM,CAAA5B,MAAM,CAAG,IAAI,CAACC,OAAO,CAACD,MAAM,CAClC,GAAM,CAAAI,KAAK,CAAGJ,MAAM,CAAC6B,SAAS,CAAC,SAACC,CAAC,QAAK,CAAAA,CAAC,CAACvB,OAAO,CAACC,GAAG,GAAKoB,EAAE,GAAC,CAC3D,GAAIxB,KAAK,GAAK,CAAC,CAAC,CAAE,CAChB;AACAJ,MAAM,CAAC+B,MAAM,CAAC3B,KAAK,CAAE,CAAC,CAAC,CACvB,IAAI,CAACH,OAAO,CAAC+B,SAAS,CAAChC,MAAM,CAAC,CAChC,CACF,CAAC,GAAAJ,GAAA,oBAAAC,KAAA,CACD,SAAA8B,iBAAA,CAAmB,KAAAM,MAAA,MACjBpD,IAAI,CAAC,CACHqD,KAAK,CAAE,eAAe,CACtBC,IAAI,CAAE,mDAAmD,CACzDC,IAAI,CAAE,SAAS,CACfC,OAAO,CAAE,IAAI,CACbC,UAAU,CAAE,IACd,CAAC,CAAC,CAACC,IAAI,CAAC,SAACC,YAAY,CAAK,CACxB,GAAIA,YAAY,CAAE,CAChB,GAAIP,MAAI,CAAChC,OAAO,CAACD,MAAM,CAACyC,MAAM,CAAG,CAAC,CAAE,CAClC,GAAM,CAAAC,KAAK,CAAGhE,QAAQ,CAACgD,QAAQ,CAACO,MAAI,CAAChC,OAAO,CAACD,MAAM,CAAC,CACpD,GAAM,CAAA2C,KAAK,CAAGV,MAAI,CAAChC,OAAO,CAACD,MAAM,CACjC,GAAM,CAAA4C,QAAQ,CAAGX,MAAI,CAAChC,OAAO,CAAC2C,QAAQ,CACtC,GAAIA,QAAQ,CAAE,CACZX,MAAI,CAACY,WAAW,CAACH,KAAK,CAAEC,KAAK,CAAEC,QAAQ,CAAC,CAC1C,CAAC,IAAM,CACLX,MAAI,CAACa,KAAK,CAACC,QAAQ,CAAC,QAAQ,CAAC,CAC/B,CACF,CAAC,IAAM,CACLlE,IAAI,CAAC,CACHqD,KAAK,CAAE,oBAAoB,CAC3BE,IAAI,CAAE,SAAS,CACfY,MAAM,CAAE,IACV,CAAC,CAAC,CACJ,CACF,CACF,CAAC,CAAC,CACJ,CACA;AAAA,GAAApD,GAAA,eAAAC,KAAA,CACA,SAAAgD,YAAYH,KAAK,CAAEC,KAAK,CAAEC,QAAQ,CAAE,KAAAK,MAAA,MAClC,GAAM,CAAAC,IAAI,CAAG,CAAER,KAAK,CAAEA,KAAK,CAAEC,KAAK,CAAEA,KAAK,CAAEC,QAAQ,CAAEA,QAAS,CAAC,CAC/D,GAAM,CAAAO,MAAM,CAAG,CAAEC,OAAO,CAAE,CAAE,gBAAgB,CAAE,IAAI,CAACnD,OAAO,CAACoD,KAAM,CAAE,CAAC,CACpE1E,KAAK,CAAC2E,IAAI,CAAC,wBAAwB,CAAEJ,IAAI,CAAEC,MAAM,CAAC,CAACZ,IAAI,CAAC,SAACgB,GAAG,CAAK,CAC/D,GAAM,CAAAC,MAAM,CAAGD,GAAG,CAACE,IAAI,CACvB,GAAID,MAAM,CAAE,CACVP,MAAI,CAAChD,OAAO,CAAC+B,SAAS,CAAC,EAAE,CAAC,CAC1BiB,MAAI,CAACH,KAAK,CAACC,QAAQ,CAAC,OAAO,CAAC,CAC9B,CAAC,IAAM,CACLW,KAAK,CAAC,iBAAiB,CAAC,CAC1B,CACF,CAAC,CAAC,CACJ,CAAC,WAAAvE,MAAA,GAtHkBX,SAAS,EAAxBW,MAAM,CACHwE,WAAW,CAAGlF,SAAS,CAuHhC,cAAe,CAAAG,UAAU,CAACO,MAAM,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}